<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html class="blacklist">
  <head>
    <title>Ubiquity Command from Untrusted Source</title>
    <link rel="stylesheet" href="chrome://global/skin/netError.css"
          type="text/css" media="all" />
    <link rel="icon" type="image/png" id="favicon"
          href="chrome://global/skin/icons/blacklist_favicon.png"/>
  </head>
  <body>
    <div id="errorPageContainer">
      <!-- Error Title -->
      <div id="errorTitle">
        <h1>Ubiquity Command from Untrusted Source</h1>
      </div>
      
      <div id="errorLongContent">

        <div id="errorShortDesc">
	  <p>You are about to subscribe to a <a href="about:ubiquity">Ubiquity</a> command from an unknown, untrusted third-party source at <a id="targetLink"></a>. If you subscribe, this command could do <i>anything it wants</i> to your browser. It could steal your credit card number or e-mail your grandmother your entire image browsing history.</p>
        </div>

        <div id="errorLongDesc">
          <p>Here is the JavaScript source code to the command:</p>

          <div id="sourceCode" style="max-height: 40em; overflow: auto;">
            <i>Loading code, please wait...</i>
          </div>

          <p>If you understand JavaScript, you should read this and
            use your best judgement to decide whether the command is
            something that's safe to execute or not. Proceed at your
            own risk!</p>

          <p>If you don't understand JavaScript, you should not
            subscribe to the command unless the link was given to you
            by someone you know and trust.</p>

          <!-- TODO: Show code fingerprint (hash+size) too. -->

          <div class="todo"
               style="border-style:solid; border-width:2px; width:80%; padding:10px; border-color:#ffff00">
            <p>In the future, we plan to have a widget here displaying
              what we call a &quot;social trust network&quot;.  You'll
              be able to see whether any of your friends have tried
              out this command.  They can either vouch for the
              command's safety or leave a warning about the command's
              dangers.  We hope this will help people make informed
              decisions about whether to subscribe to commands or not.
              This feature should be coming in Ubiquity 0.2.</p>
          </div>
        </div>
        <div id="buttons">
          <p id="autoupdate-widget">
          <input type="checkbox" id="autoupdate"/>
          <label for="autoupdate" style="font-size: larger;">Auto-update this feed.</label>
          <ul id="autoupdate-warning" style="display: none;">
            <p>This means that the feed will constantly be checked for
            functionality updates and automatically pushed to your
            computer.  If you check this, make sure that you trust the
            people who have access to change this code on the server
            that it's hosted on.</p>
            <p id="mitm-warning" style="display: none;">Note that
              this feed is served using an insecure protocol, and is
              therefore subject to <a target="_blank"
              href="http://blog.johnath.com/2008/08/05/ssl-question-corner/">man-in-the-middle
              attacks</a>.  Please only auto-update this feed if you
              are sure about the implications of what you're
              doing.</p>
          </ul>
          <!-- TODO: Add description. If it's http (not https), -->
          <!-- we should deliver extra warnings about MITM vulns. -->
          </p>
	  <p>
            <input type="submit" value="Get me outta here!"
                   onclick="onCancel();"/>
            &nbsp;&nbsp;&nbsp;&nbsp;
            <input type="submit"
                   value="I know what I'm doing. Subscribe to it!"
                   onclick="onSubmit();"/>
          </p>
        </div>
      </div>
    </div>
    <div id="confirmationContainer" style="display: none;">
      <div id="confirmationShortDesc">
      <p>You are now subscribing to the command feed and can use its functionality.</p>
      </div>
      <div id="confirmationLongDesc">

        <p>If you ever want to unsubscribe, you can use the Ubiquity
          &quot;help&quot; command at any time to get to
          the <a href="about:ubiquity">command management page</a>,
          where you can see what commands you are subscribed to, and
          cancel any that you no longer want.</p>

        <p>You may now close this window.</p>
      </div>
    </div>
  </body>
  <script src="resource://ubiquity/scripts/jquery.js"></script>
  <script type="application/javascript;version=1.7"
          src="confirm-add-command.js"></script>
</html>
